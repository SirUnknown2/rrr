q()

library(MMST)

library(MASS)

library(dplyr)

library(ggplot2)

library(lattice)

data(wine)


wine <- as_data_frame(wine) %>% dplyr::select(-classdigit)
rrlda(wine)
wine
wine_y <- dplyr::select(wine, class)
wine_x <- dplyr::select(wine, -class)
rrlda(wine_x, wine_y)
binary_matrix <- function(class) {
    class <- dplyr::mutate_if(class, is.factor, as.character) %>% as.matrix()
    mat <- model.matrix(~ class -1)
##    mat <- dplyr::select(mat, -dim(mat)[2])
##    names(mat) <- substring(names(mat), 4, 100)
    mat
}
rrlda(wine_x, wine_y)
rrlda <- function(x, y, k = 0, rank = "full") {
### build Y matrix
    y_binary <- binary_matrix(y)
### centering matrix
    n <- dim(y_binary)[1]
    centering_matrix <- diag(1, n) - matrix(1, n, n) / n
    y_center <- t(y_binary) %*% centering_matrix
    x_center <- organize(x)
    s_yy <- y_center %*% t(y_center) + k * diag(1, dim(y_center)[1])
    s_xy <- x_center %*% t(y_center)
    s_yx <- t(s_xy)
    s_xx <- x_center %*% t(x_center) + k * diag(1, dim(x_center)[1])
    R_star <- solve(sqrt_matrix(s_xx)) %*%
        s_xy %*% solve(s_yy) %*%
        s_yx %*%
        solve(sqrt_matrix(s_xx))
    R_star
   ### V_star <- eigen(R_star)$vectors[,1:rank]
    ###V_star
}

rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
binary_matrix <- function(class) {
    class <- dplyr::mutate_if(class, is.factor, as.character) %>% as.matrix()
    mat <- model.matrix(~ class -1)
##    mat <- dplyr::select(mat, -dim(mat)[2])
##    names(mat) <- substring(names(mat), 4, 100)
    mat
}
rrlda(wine_x, wine_y)
matrix(1, 3)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
binary_matrix(wine_y)
colSums(binary_matrix(wine_y))
bm <- binary_matrix(wine_y)
as.vector(colSums(bm))
as.vector(colSums(bm)) ->gn
1 / gn
diag(1/gn)
diag(1/gn) + 1 / gn * matrix(1, gn, gn)
matrix(1, gn, gn)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda <- function(x, y, k = 0, rank = "full") {
### build Y matrix
    y_binary <- binary_matrix(y)
### centering matrix
    n <- dim(y_binary)[1]
    centering_matrix <- diag(1, n) - matrix(1, n, n) / n
    y_center <- t(y_binary) %*% centering_matrix
    n_class <- as.vector(colSum .... [TRUNCATED] 
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda <- function(x, y, k = 0) {
### build Y matrix
    y_binary <- binary_matrix(y)
### centering matrix
    n <- dim(y_binary)[1]
    centering_matrix <- diag(1, n) - matrix(1, n, n) / n
    y_center <- t(y_binary) %*% centering_matrix
    n_class <- as.vector(colSums(y_binary))
 .... [TRUNCATED] 
rrlda <- function(x, y, k = 0) {
### build Y matrix
    y_binary <- binary_matrix(y)
### centering matrix
    n <- dim(y_binary)[1]
    centering_matrix <- diag(1, n) - matrix(1, n, n) / n
    y_center <- t(y_binary) %*% centering_matrix
    n_class <- as.vector(colSums(y_binary))
 .... [TRUNCATED] 
}
}
}
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)

. + 
}
rrlda(wine_x, wine_y)
rrlda <- function(x, y, k = 0, ld_num = 2) {
### build Y matrix
    y_binary <- binary_matrix(y)
### centering matrix
    n <- dim(y_binary)[1]
    centering_matrix <- diag(1, n) - matrix(1, n, n) / n
    y_center <- t(y_binary) %*% centering_matrix
    n_class <- as.vector(colSums(y .... [TRUNCATED] 
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y) %*% wine_x
rrlda(wine_x, wine_y) %*% organize(wine_x)
rrlda(wine_x, wine_y) %*% organize(wine_x)
organize <- function(vars, scale = FALSE){
t(scale(as.matrix(vars), center = TRUE, scale = sclae))
}
rrlda(wine_x, wine_y) %*% organize(wine_x)
> organize <- function(vars, scale = FALSE){
 t(scale(as.matrix(vars), center = TRUE, scale = scale))

 }
organize <- function(vars, scale = FALSE){
t(scale(as.matrix(vars), center = TRUE, scale = scale))
}
rrlda(wine_x, wine_y) %*% organize(wine_x)
organize(wine_x)
t(rrlda(wine_x, wine_y) %*% organize(wine_x)
)
t(rrlda(wine_x, wine_y)) %*% organize(wine_x)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
wine_lda <- rrlda(wine_x, wine_y)$Xi
plot(wine_lda$V1, wine_lda$V2)
ggplot(wine_lda, aes(V1, V2)) + geom_point()
wine_lda2 <- rrlda(wine_x, wine_y)$Omega
ggplot(wine_lda2, aes(V1, V2)) + geom_point()
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2)))
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2))
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = red)
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red")
rrlda(wine_x, wine_y)
wine_lda <- rrlda(wine_x, wine_y)$Xi
wine_lda2 <- rrlda(wine_x, wine_y)$Omega
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red")
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
wine_lda <- rrlda(wine_x, wine_y)$Xi
wine_lda2 <- rrlda(wine_x, wine_y)$Omega
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red")
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red")
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2))
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2))
rrlda(wine_x, wine_y)
wine_lda <- rrlda(wine_x, wine_y)$Xi
wine_lda2 <- rrlda(wine_x, wine_y)$Omega
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 3)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
ggplot(wine_lda, aes(V1, V2)) + geom_point(color = class) + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2, class)) + geom_point(color = class) + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2, class)) + geom_point(color = class) + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
rrlda(wine_x, wine_y)
rrlda(wine_x, wine_y)
typeof(rrlda(wine_x, wine_y)$Xi)
rrlda(wine_x, wine_y)
ggplot(wine_lda, aes(V1, V2)) + geom_point(color = class) + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
?aes
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
wine_lda <- rrlda(wine_x, wine_y)$Xi
wine_lda2 <- rrlda(wine_x, wine_y)$Omega
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "red", size = 2)
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "black", size = 2)
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "black", size = 2, shape = "square")
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "black", shape = "square", size = 3)
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "black", shape = "M", size = 3)
ggplot(wine_lda, aes(V1, V2, color = class)) + geom_point() + geom_point(aes(wine_lda2$V1, wine_lda2$V2), color = "black", shape = "M", size = 4)
wine_lda <- rrlda(wine_x, wine_y)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot(wine_lda)
lda_plot <- function(rrlda_object){
    Xi <- rrlda_object$Xi
    Omega <- rrlda_object$Omega
    ggplot(Xi,
           aes(V1, V2, color = class)) +
        geom_point() +
        geom_point(aes(Omega$V1,
                       Omega$V2),
                   color = "black",
     .... [TRUNCATED] 
}
lda_plot(wine_lda)
rrlda(wine_x, wine_y, k = .001)
lda_plot(rrlda(wine_x, wine_y, k = .001))
lda_plot(rrlda(wine_x, wine_y, k = .001))
lda_plot(rrlda(wine_x, wine_y))
