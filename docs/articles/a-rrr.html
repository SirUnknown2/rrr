<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title><code>rrr</code> for Multivariate Regression &bull; rrr</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rrr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/chrisaddy/rrr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1><code>rrr</code> for Multivariate Regression</h1>
                        <h4 class="author">Chris Addy</h4>
            
            <h4 class="date">2016-11-29</h4>
          </div>

    
    
<div class="contents">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rrr)</code></pre></div>
<div id="classical-multivariate-regression" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#classical-multivariate-regression" class="anchor"> </a></body></html>Classical Multivariate Regression</h2>
<p>Let <span class="math inline">\(\mathbf{X} = \left(X_1, X_2, \dots, X_r\right)^\tau\)</span> and <span class="math inline">\(\mathbf{Y} = \left(Y_1, Y_2, \dots, Y_s\right)^\tau\)</span>, i.e., <span class="math inline">\(\mathbf{X}\)</span> is a random vector. The classical multivariate regression model is given by</p>
<p><span class="math display">\[
\overset{s \times 1}{\mathbf{Y}} = \overset{s \times 1}{\boldsymbol{\mu}} + \overset{s \times r}{\mathbf{C}} \; \overset{r \times 1}{\mathbf{X}} + \overset{s \times 1}{\varepsilon}
\]</span></p>
<p>with</p>
<p><span class="math display">\[
\mathrm{E}\left(\varepsilon\right) = \mathbf{0}, \quad \mathrm{cov}\left(\varepsilon\right) = \mathbf{\Sigma}_{\varepsilon \varepsilon}
\]</span></p>
<p>and <span class="math inline">\(\varepsilon\)</span> is distributed independently of <span class="math inline">\(\mathbf{X}.\)</span></p>
<p>To estimate <span class="math inline">\(\boldsymbol{\mu}\)</span> and <span class="math inline">\(\mathbf{C}\)</span> we minimize the least-squares criterion</p>
<p><span class="math display">\[
\mathrm{E}\left[\left(\mathbf{Y} - \boldsymbol{\mu} - \mathbf{C} \mathbf{X}\right)\left(\mathbf{Y} - \boldsymbol{\mu} - \mathbf{C}\mathbf{X}\right)^\tau\right],
\]</span></p>
<p>with expecation taken over the joint distribution of <span class="math inline">\(\left(\mathbf{X}^\tau, \mathbf{Y}^\tau\right)\)</span>, with the assumption that <span class="math inline">\(\mathbf{\Sigma}_{XX}\)</span> is nonsingular, and therefore invertible.</p>
<p>This is minimized when</p>
<p><span class="math display">\[
\begin{aligned}
    \boldsymbol{\mu} &amp; = \boldsymbol{\mu}_Y - \mathbf{C} \boldsymbol{\mu} \\
    \mathbf{C} &amp; = \mathbf{\Sigma}_{YX} \mathbf{\Sigma}_{XX}^{-1}
\end{aligned}
\]</span></p>
<p>The least-squares estimator of <span class="math inline">\(\mathbf{C}\)</span> is given by</p>
<p><span class="math display">\[
\hat{\mathbf{C}} = \hat{\mathbf{\Sigma}}_{YX} \hat{\mathbf{\Sigma}}_{XX}^{-1}
\]</span></p>
<p>Note that <span class="math inline">\(\mathbf{C}\)</span> and hence <span class="math inline">\(\hat{\mathbf{C}}\)</span> contains no term that takes into the account the correlation of the <span class="math inline">\(Y_i\)</span>s. This is a surprising result, since we would expect correlation among the responses.</p>
<p>In other words, to find the least-squares estimate <span class="math inline">\(\hat{\mathbf{C}}\)</span> of <span class="math inline">\(\mathbf{C}\)</span>, one need only regress <span class="math inline">\(\mathbf{X}\)</span> separately on each <span class="math inline">\(Y_i\)</span> and concatenate those multiple-regression coefficient vectors into a matrix to construct the estimated coefficient matrix <span class="math inline">\(\hat{\mathbf{C}}\)</span>.</p>
<p>The classical multivariate regression model is not <em>truly</em> multivariate.</p>
</div>
<div id="the-tobacco-data-set" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#the-tobacco-data-set" class="anchor"> </a></body></html>The <code>tobacco</code> Data Set</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">data</span>(tobacco)

tobacco &lt;-<span class="st"> </span><span class="kw">as_data_frame</span>(tobacco)

<span class="kw">glimpse</span>(tobacco)</code></pre></div>
<pre><code>## Observations: 25
## Variables: 9
## $ Y1.BurnRate          &lt;dbl&gt; 1.55, 1.63, 1.66, 1.52, 1.70, 1.68, 1.78,...
## $ Y2.PercentSugar      &lt;dbl&gt; 20.05, 12.58, 18.56, 18.56, 14.02, 15.64,...
## $ Y3.PercentNicotine   &lt;dbl&gt; 1.38, 2.64, 1.56, 2.22, 2.85, 1.24, 2.86,...
## $ X1.PercentNitrogen   &lt;dbl&gt; 2.02, 2.62, 2.08, 2.20, 2.38, 2.03, 2.87,...
## $ X2.PercentChlorine   &lt;dbl&gt; 2.90, 2.78, 2.68, 3.17, 2.52, 2.56, 2.67,...
## $ X3.PercentPotassium  &lt;dbl&gt; 2.17, 1.72, 2.40, 2.06, 2.18, 2.57, 2.64,...
## $ X4.PercentPhosphorus &lt;dbl&gt; 0.51, 0.50, 0.43, 0.52, 0.42, 0.44, 0.50,...
## $ X5.PercentCalcium    &lt;dbl&gt; 3.47, 4.57, 3.52, 3.69, 4.01, 2.79, 3.92,...
## $ X6.PercentMagnesium  &lt;dbl&gt; 0.91, 1.25, 0.82, 0.97, 1.12, 0.82, 1.06,...</code></pre>
<p>We see that the <code>tobacco</code> data set<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> has 9 variables and 25 observations. There are 6 <span class="math inline">\(X_i\)</span> predictor variables &ndash; representing the percentages of nitrogen, chlorine, potassium, phosphorus, calcium, and magnesium, respectively &ndash; and 3 <span class="math inline">\(Y_j\)</span> response variables &ndash; representing cigarette burn rates in inches per 1,000 seconds, percent sugar in the leaf, and percent nicotine in the leaf, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tobacco_x &lt;-<span class="st"> </span>tobacco %&gt;%
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"X"</span>))

tobacco_y &lt;-<span class="st"> </span>tobacco %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"Y"</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggcorr</span>(tobacco_x)</code></pre></div>
<p><img src="a-rrr_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggcorr</span>(tobacco_y)</code></pre></div>
<p><img src="a-rrr_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## multivariate regression

x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tobacco_x)
y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tobacco_y)

multivar_reg &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">cov</span>(y, x) %*%<span class="st"> </span><span class="kw">solve</span>(<span class="kw">cov</span>(x)))

## separate multiple regression

lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y[,<span class="dv">1</span>] ~<span class="st"> </span>x)$coeff
lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y[,<span class="dv">2</span>] ~<span class="st"> </span>x)$coeff
lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y[,<span class="dv">3</span>] ~<span class="st"> </span>x)$coeff

### compare multivariate regression and separate multiple regresions

multivar_reg</code></pre></div>
<pre><code>##                      Y1.BurnRate Y2.PercentSugar Y3.PercentNicotine
## X1.PercentNitrogen    0.06197282      -4.3186662          0.5521620
## X2.PercentChlorine   -0.16012848       1.3262863         -0.2785609
## X3.PercentPotassium   0.29211810       1.5899470          0.2175877
## X4.PercentPhosphorus -0.65798016      13.9526510         -0.7231067
## X5.PercentCalcium     0.17302593       0.5525913          0.3230914
## X6.PercentMagnesium  -0.42834825      -3.5021083          2.0048603</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(lm1, lm2, lm3)</code></pre></div>
<pre><code>##                               lm1        lm2        lm3
## (Intercept)            1.41113730 13.6329133 -1.5648236
## xX1.PercentNitrogen    0.06197282 -4.3186662  0.5521620
## xX2.PercentChlorine   -0.16012848  1.3262863 -0.2785609
## xX3.PercentPotassium   0.29211810  1.5899470  0.2175877
## xX4.PercentPhosphorus -0.65798016 13.9526510 -0.7231067
## xX5.PercentCalcium     0.17302593  0.5525913  0.3230914
## xX6.PercentMagnesium  -0.42834825 -3.5021083  2.0048603</code></pre>
</div>
<div id="reduced-rank-regression" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#reduced-rank-regression" class="anchor"> </a></body></html>Reduced-Rank Regression</h2>
<p>One way to introduce a multivariate component into the model is to allow for the possibility that <span class="math inline">\(\mathbf{C}\)</span> is deficient, or of <em>reduced-rank</em> <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
\mathrm{rank}\left(\mathbf{C}\right) = t \leq \mathrm{min}\left(r, s\right)
\]</span></p>
<p>In other words, we allow for the possibility that there are unknown linear constraints on <span class="math inline">\(\mathbf{C}\)</span>.</p>
<p>Without loss of generality, we consider the case when <span class="math inline">\(r &gt; s\)</span>, i.e., <span class="math inline">\(t &lt; s\)</span>.</p>
<p>When <span class="math inline">\(t = s\)</span>, the regression model is <em>full-rank</em>, and can be fit using multiple regression on each <span class="math inline">\(Y_i \in \mathbf{Y}.\)</span> When <span class="math inline">\(t &lt; s\)</span>, <span class="math inline">\(\mathbf{C}\)</span> can be decomposed into non-unique matrices <span class="math inline">\(\mathbf{A}_{s \times t}\)</span> and <span class="math inline">\(\mathbf{B}_{t \times r}\)</span>, such that <span class="math inline">\(\mathbf{C} = \mathbf{AB},\)</span> and the multivariate regression model is given by</p>
<p><span class="math display">\[
\overset{s \times 1}{\mathbf{Y}} = \overset{s \times 1}{\boldsymbol{\mu}} + \overset{s \times t}{\mathbf{A}} \; \overset{t \times r}{\mathbf{B}} \; \overset{r \times 1}{\mathbf{X}} + \overset{s \times 1}{\varepsilon}
\]</span></p>
<p>Estimating <span class="math inline">\(\boldsymbol{\mu}, \mathbf{A}, \mathbf{B}\)</span>, and ultimately the <em>reduced-rank regression coefficient</em> <span class="math inline">\(\mathbf{C}^{\left(t\right)}\)</span>, is done by minimizing the weighted sum-of-squares criterion</p>
<p><span class="math display">\[
\mathrm{E}\left[\left(\mathbf{Y} - \boldsymbol{\mu} - \mathbf{ABX}\right)^\tau \mathbf{\Gamma}\left(\mathbf{Y} - \boldsymbol{\mu} - \mathbf{ABX}\right)\right]
\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\Gamma}\)</span> is a positive-definite symmetric <span class="math inline">\(\left(s \times s\right)\)</span>-matrix of weights, the expectation of which is taken over the joint distribution <span class="math inline">\(\left(\mathbf{X}^\tau, \mathbf{Y}^\tau\right)^\tau\)</span>. This weighted sum-of-squares criterion is minimized when</p>
<p><span class="math display">\[
\begin{aligned}
\boldsymbol{\mu}^{\left(t\right)} &amp; = \boldsymbol{\mu}_Y - \mathbf{A}^{\left(t\right)}\mathbf{B}^{\left(t\right)}\boldsymbol{\mu}_X \\
        \mathbf{A}^{\left(t\right)} &amp; = \mathbf{\Gamma}^{-1/2}\mathbf{V}_t \\
        \mathbf{B}^{\left(t\right)} &amp; = \mathbf{V}_t^\tau \boldsymbol{\Gamma}^{-1/2}\mathbf{\Sigma}_{YX}\mathbf{\Sigma}_{XX}^{-1} \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{V}_t = \left(\mathbf{v}_1, \dots, \mathbf{v}_t\right)\)</span> is an <span class="math inline">\(\left(s \times t\right)\)</span>-matrix, with <span class="math inline">\(\mathbf{v}_j\)</span> the eigenvector associated with the <span class="math inline">\(j\)</span>th largest eigenvalue of</p>
<p><span class="math display">\[
\mathbf{\Gamma}^{1/2}\mathbf{\Sigma}_{YX} \mathbf{\Sigma}_{XX}^{-1} \mathbf{\Sigma}_{XY} \mathbf{\Gamma}^{1/2}
\]</span></p>
<p>In practice, we try out different values of <span class="math inline">\(\mathbf{\Gamma}\)</span>. Two popular choices &ndash; and ones that lead to interesting results as we will see &ndash; are <span class="math inline">\(\mathbf{\Gamma} = \mathbf{I}_r\)</span> and <span class="math inline">\(\mathbf{\Gamma} = \boldsymbol{\Sigma}_{YY}^{-1}\)</span>.</p>
<p>Since the reduced-rank regression coefficient relies on inverting <span class="math inline">\(\boldsymbol{\Sigma}_{XX}\)</span> and, possibly, <span class="math inline">\(\boldsymbol{\Sigma}_{YY}\)</span>, we want to take into consideration the cases when <span class="math inline">\(\boldsymbol{\Sigma}_{XX}, \boldsymbol{\Sigma}_{YY}\)</span> are singular or difficult to invert.</p>
<p>Borrowing from ridge regression, we perturb the diagonal of the covariance matrices by some small constant, <span class="math inline">\(k\)</span>. Thus, we carry out the reduced-rank regression procedure using</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\boldsymbol{\Sigma}}_{XX}^{\left(k\right)} &amp; = \hat{\boldsymbol{\Sigma}}_{XX} + k \mathbf{I}_r \\
\hat{\boldsymbol{\Sigma}}_{YY}^{\left(k\right)} &amp; = \hat{\boldsymbol{\Sigma}}_{YY} + k \mathbf{I}_r
\end{aligned}
\]</span></p>
</div>
<div id="assessessing-effective-dimensionality" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#assessessing-effective-dimensionality" class="anchor"> </a></body></html>Assessessing Effective Dimensionality</h2>
<div id="estimate-t-and-k-with-rank_trace-and-rank_trace_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#estimate-t-and-k-with-rank_trace-and-rank_trace_plot" class="anchor"> </a></body></html>Estimate <span class="math inline">\(t\)</span> and <span class="math inline">\(k\)</span> with <code><a href="../reference/rank_trace.html">rank_trace()</a></code> and <code><a href="../reference/rank_trace_plot.html">rank_trace_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rank_trace)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rank_trace_plot)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, type = "cov", k = 0) 
## NULL</code></pre>
<p>Since <span class="math inline">\(\hat{\mathbf{C}}\)</span> is calculated using sample observations, its <em>mathematical</em> rank will always be full, but it will have a <em>statistical</em> rank <span class="math inline">\(t\)</span> that is an unknown hyperparameter that</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### use the identity matrix for gamma

ident &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span>, <span class="kw">dim</span>(tobacco_y)[<span class="dv">2</span>])

<span class="kw"><a href="../reference/rank_trace.html">rank_trace</a></span>(tobacco_x, tobacco_y, ident) </code></pre></div>
<pre><code>## # A tibble: 4 &times; 3
##   ranks         dC         dEE
##   &lt;int&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     0 1.00000000 1.000000000
## 2     1 0.20198327 0.011933691
## 3     2 0.08419093 0.003095346
## 4     3 0.00000000 0.000000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rank_trace_plot.html">rank_trace_plot</a></span>(tobacco_x, tobacco_y, ident)</code></pre></div>
<p><img src="a-rrr_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### use inverse of estimated covariance of Y for gamma

gamma2 &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">cov</span>(tobacco_y))

<span class="kw"><a href="../reference/rank_trace.html">rank_trace</a></span>(tobacco_x, tobacco_y, gamma2)</code></pre></div>
<pre><code>## # A tibble: 4 &times; 3
##   ranks        dC        dEE
##   &lt;int&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1     0 1.0000000 1.00000000
## 2     1 0.5546365 0.08594144
## 3     2 0.4063885 0.03296964
## 4     3 0.0000000 0.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rank_trace_plot.html">rank_trace_plot</a></span>(tobacco_x, tobacco_y, gamma2)</code></pre></div>
<p><img src="a-rrr_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
</div>
<div id="fitting-reduced-rank-regression-model" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#fitting-reduced-rank-regression-model" class="anchor"> </a></body></html>Fitting Reduced-Rank Regression Model</h2>
<div id="fit-reduced-rank-regression-model-with-rrr" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#fit-reduced-rank-regression-model-with-rrr" class="anchor"> </a></body></html>Fit reduced-rank regression model with <code><a href="../reference/rrr.html">rrr()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rrr)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<p>The main function in the <code>rrr</code> package is &ndash; unsurprisingly &ndash; <code><a href="../reference/rrr.html">rrr()</a></code></p>
<p><code><a href="../reference/rrr.html">rrr()</a></code> takes as inputs the data frames, or matrices, of input and response variables, the weight matrix <span class="math inline">\(\mathbf{\Gamma}\)</span>, the rank (defaulted to full rank), the type of covariance matrix to be used (either covariance or correlation), and the ridge constant <span class="math inline">\(k\)</span>.</p>
<p><code><a href="../reference/rrr.html">rrr()</a></code> returns a <code>list</code> containing the means <span class="math inline">\(\hat{\boldsymbol{\mu}}\)</span>, the matrices <span class="math inline">\(\hat{\mathbf{A}}\)</span>, <span class="math inline">\(\hat{\mathbf{B}}\)</span>, and the coefficient matrix <span class="math inline">\(\hat{\mathbf{C}}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rrr.html">rrr</a></span>(tobacco_x, tobacco_y, ident, <span class="dt">rank =</span> <span class="st">"full"</span>) </code></pre></div>
<pre><code>## $mean
##           [,1]
## [1,]  1.411137
## [2,] 13.632913
## [3,] -1.564824
## 
## $A
##             [,1]       [,2]      [,3]
## [1,]  0.03107787 -0.4704307 0.8818895
## [2,] -0.97005030  0.1984637 0.1400521
## [3,]  0.24090782  0.8598297 0.4501736
## 
## $B
##      X1.PercentNitrogen X2.PercentChlorine X3.PercentPotassium
## [1,]          4.3242696        -1.35864835          -1.4808316
## [2,]         -0.4114869         0.09903401           0.3652138
## [3,]         -0.3016163        -0.08086722           0.5782436
##      X4.PercentPhosphorus X5.PercentCalcium X6.PercentMagnesium
## [1,]           -13.729424        -0.4528289          3.86689562
## [2,]             2.456879         0.3060762          1.23030547
## [3,]             1.048309         0.3754285          0.03430168
## 
## $C
##      X1.PercentNitrogen X2.PercentChlorine X3.PercentPotassium
## [1,]         0.06197282         -0.1601285           0.2921181
## [2,]        -4.31866620          1.3262863           1.5899470
## [3,]         0.55216201         -0.2785609           0.2175877
##      X4.PercentPhosphorus X5.PercentCalcium X6.PercentMagnesium
## [1,]           -0.6579802         0.1730259          -0.4283482
## [2,]           13.9526510         0.5525913          -3.5021083
## [3,]           -0.7231067         0.3230914           2.0048603
## 
## $eigen_values
## [1] 3.28209974 0.03782978 0.01015996</code></pre>
<p>We can see that <code><a href="../reference/rrr.html">rrr()</a></code> with <code>rank = "full"</code> and <code>k = 0</code> returns the classical multivariate regression coefficients as before. They differ only by a transpose, and is presented this way in <code>rrr</code> as a matter of convention. It is this form that is presented in the literature (Izenman, 2008).</p>
</div>
</div>
<div id="diagnostics" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#diagnostics" class="anchor"> </a></body></html>Diagnostics</h2>
<div id="calculate-residuals-with-rrr_residuals" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#calculate-residuals-with-rrr_residuals" class="anchor"> </a></body></html>Calculate Residuals with <code><a href="../reference/rrr_residuals.html">rrr_residuals()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rrr_residuals_plot)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rrr_residuals.html">rrr_residuals</a></span>(tobacco_x, tobacco_y, ident, <span class="dt">rank =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## # A tibble: 25 &times; 3
##    Y1.BurnRate Y2.PercentSugar Y3.PercentNicotine
##          &lt;dbl&gt;           &lt;dbl&gt;              &lt;dbl&gt;
## 1  -0.15358056       3.9207245         -0.9019766
## 2  -0.20963638       0.6975085         -0.6966471
## 3  -0.07296342       3.3478677         -0.9497452
## 4  -0.20128009       2.9831896         -0.1991789
## 5  -0.12358413       1.6364610         -0.3622142
## 6  -0.04949370       0.3195653         -1.2428487
## 7  -0.04185307       2.0824285         -0.3387954
## 8  -0.14497977       2.7465342         -0.1903404
## 9  -0.09788965       1.5330911         -0.5878621
## 10 -0.35531326       2.6111104         -0.3332054
## # ... with 15 more rows</code></pre>
</div>
<div id="plot-residuals-with-rrr_residuals_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#plot-residuals-with-rrr_residuals_plot" class="anchor"> </a></body></html>Plot Residuals with <code><a href="../reference/rrr_residuals_plot.html">rrr_residuals_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rrr_residuals)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<p>We can visually check the model assumptions that</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rrr_residuals_plot.html">rrr_residuals_plot</a></span>(tobacco_x, tobacco_y, ident, <span class="dt">rank =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="a-rrr_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
</div>
<div class="footnotes">
<hr><ol><li id="fn1"><p>Anderson, R.L and Bancroft, T.A (1952). <em>Statistical Theory in Research</em>, New York: McGraw-Hill. p.&nbsp;205.<a href="#fnref1">&#8617;</a></p></li>
</ol></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#classical-multivariate-regression">Classical Multivariate Regression</a></li>
      <li><a href="#the-tobacco-data-set">The <code>tobacco</code> Data Set</a></li>
      <li><a href="#reduced-rank-regression">Reduced-Rank Regression</a></li>
      <li><a href="#assessessing-effective-dimensionality">Assessessing Effective Dimensionality</a></li>
      <li><a href="#fitting-reduced-rank-regression-model">Fitting Reduced-Rank Regression Model</a></li>
      <li><a href="#diagnostics">Diagnostics</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Chris Addy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
