<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title><code>rrr</code> for Canonical Variate Analysis &bull; rrr</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rrr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/chrisaddy/rrr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><script src="cva_files/htmlwidgets-0.8/htmlwidgets.js"></script><link href="cva_files/plotlyjs-1.16.3/plotly-htmlwidgets.css" rel="stylesheet"><script src="cva_files/plotlyjs-1.16.3/plotly-latest.min.js"></script><script src="cva_files/plotly-binding-4.5.6/plotly.js"></script><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1><code>rrr</code> for Canonical Variate Analysis</h1>
                        <h4 class="author">Chris Addy</h4>
            
            <h4 class="date">2016-12-06</h4>
          </div>

    
    
<div class="contents">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
<span class="kw">library</span>(rrr)
<span class="kw">library</span>(dplyr)</code></pre></div>
<div id="mathematical-background" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#mathematical-background" class="anchor"> </a></body></html>Mathematical Background</h2>
<div id="cva-is-a-special-case-of-reduced-rank-regression" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#cva-is-a-special-case-of-reduced-rank-regression" class="anchor"> </a></body></html>CVA is a Special Case of <a href="rrr.html">Reduced-Rank Regression</a></h3>
</div>
</div>
<div id="the-combo17-data-set" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#the-combo17-data-set" class="anchor"> </a></body></html>The <code>COMBO17</code> Data Set</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### COMBO-17 galaxy data
<span class="kw">data</span>(COMBO17)
galaxy &lt;-<span class="st"> </span><span class="kw">as_data_frame</span>(COMBO17) %&gt;%
<span class="st">       </span><span class="kw">select</span>(-<span class="kw">starts_with</span>(<span class="st">"e."</span>), -Nr, -UFS:-IFD) %&gt;%
<span class="st">       </span><span class="kw">na.omit</span>()

<span class="kw">glimpse</span>(galaxy)</code></pre></div>
<pre><code>## Observations: 3,462
## Variables: 29
## $ Rmag    &lt;dbl&gt; 24.995, 25.013, 24.246, 25.203, 25.504, 23.740, 25.706...
## $ ApDRmag &lt;dbl&gt; 0.935, -0.135, 0.821, 0.639, -1.588, -1.636, 0.199, -0...
## $ mumax   &lt;dbl&gt; 24.214, 25.303, 23.511, 24.948, 24.934, 24.609, 25.271...
## $ Mcz     &lt;dbl&gt; 0.832, 0.927, 1.202, 0.912, 0.848, 0.882, 0.896, 0.930...
## $ MCzml   &lt;dbl&gt; 1.400, 0.864, 1.217, 0.776, 1.330, 0.877, 0.870, 0.877...
## $ chi2red &lt;dbl&gt; 0.64, 0.41, 0.92, 0.39, 1.45, 0.52, 1.31, 1.84, 1.03, ...
## $ UjMAG   &lt;dbl&gt; -17.67, -18.28, -19.75, -17.83, -17.69, -19.22, -17.09...
## $ BjMAG   &lt;dbl&gt; -17.54, 17.86, -19.91, -17.39, -18.40, -18.11, -16.06,...
## $ VjMAG   &lt;dbl&gt; -17.76, -18.20, -20.41, -17.67, -19.37, -18.70, -16.23...
## $ usMAG   &lt;dbl&gt; -17.83, -18.42, -19.87, -17.98, -17.81, -19.34, -17.26...
## $ gsMAG   &lt;dbl&gt; -17.60, -17.96, -20.05, -17.47, -18.69, -18.27, -16.11...
## $ rsMAG   &lt;dbl&gt; -17.97, -18.43, -20.71, -17.89, -19.88, -19.05, -16.39...
## $ UbMAG   &lt;dbl&gt; -17.76, -18.36, -19.82, -17.92, -17.76, -19.30, -17.19...
## $ BbMAG   &lt;dbl&gt; -17.53, -17.85, -19.89, -17.38, -18.35, -18.08, -16.05...
## $ VnMAG   &lt;dbl&gt; -17.76, -18.19, -20.40, -17.67, -19.37, -18.69, -16.22...
## $ S280MAG &lt;dbl&gt; -1.822e+01, -1.797e+01, -1.977e+01, -1.812e+01, -1.393...
## $ W420FE  &lt;dbl&gt; 0.0006600, 0.0003240, 0.0129700, 0.0118600, 0.0013450,...
## $ W462FE  &lt;dbl&gt; 0.012700, 0.005135, 0.019670, 0.015900, 0.005088, 0.00...
## $ W485FD  &lt;dbl&gt; 0.0188500, 0.0027290, 0.0255200, 0.0015550, 0.0018450,...
## $ W518FE  &lt;dbl&gt; 0.0182300, 0.0007852, 0.0159200, 0.0026140, 0.0099620,...
## $ W571FS  &lt;dbl&gt; 0.014680, 0.009910, 0.022890, 0.001756, 0.003439, 0.00...
## $ W604FE  &lt;dbl&gt; 0.016640, 0.009047, 0.023380, 0.009163, 0.006316, 0.00...
## $ W646FD  &lt;dbl&gt; 0.0188000, 0.0029790, 0.0231200, 0.0063330, -0.0001841...
## $ W696FE  &lt;dbl&gt; 0.024620, 0.009830, 0.027220, 0.012330, 0.005536, 0.00...
## $ W753FE  &lt;dbl&gt; 0.0244700, 0.0142100, 0.0354400, 0.0022500, 0.0161700,...
## $ W815FS  &lt;dbl&gt; 0.021560, 0.014710, 0.045340, 0.016880, 0.006755, 0.00...
## $ W856FD  &lt;dbl&gt; 0.024410, 0.011420, 0.078100, 0.008749, 0.010220, 0.00...
## $ W914FD  &lt;dbl&gt; 0.0377200, 0.0102800, 0.0711400, 0.0069970, 0.0132800,...
## $ W914FE  &lt;dbl&gt; 0.011660, 0.026270, 0.064050, 0.005865, 0.019850, 0.02...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">galaxy_x &lt;-<span class="st"> </span>galaxy %&gt;%
<span class="st">    </span><span class="kw">select</span>(-Rmag:-chi2red)

galaxy_y &lt;-<span class="st"> </span>galaxy %&gt;%
<span class="st">    </span><span class="kw">select</span>(Rmag:chi2red)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggcorr</span>(galaxy_x)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggcorr</span>(galaxy_y)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="assessing-effective-dimensionality" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#assessing-effective-dimensionality" class="anchor"> </a></body></html>Assessing Effective Dimensionality</h2>
<div id="estimate-t-and-k-with-cva_rank_trace-and-cva_rank_trace_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#estimate-t-and-k-with-cva_rank_trace-and-cva_rank_trace_plot" class="anchor"> </a></body></html>Estimate <span class="math inline">\(t\)</span> and <span class="math inline">\(k\)</span> with <code><a href="../reference/cva_rank_trace.html">cva_rank_trace()</a></code> and <code><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_rank_trace.html">cva_rank_trace</a></span>(galaxy_x, galaxy_y)</code></pre></div>
<pre><code>## # A tibble: 7 &times; 3
##   ranks        dC         dEE
##   &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1     0 1.0000000 1.000000000
## 2     1 0.9912825 0.805325582
## 3     2 0.3245965 0.013313406
## 4     3 0.3012955 0.012360544
## 5     4 0.2970647 0.012088297
## 6     5 0.1678916 0.005243693
## 7     6 0.0000000 0.000000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot</a></span>(galaxy_x, galaxy_y)</code></pre></div>
<div id="htmlwidget-613e9b541a02f0a2ff5f" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-613e9b541a02f0a2ff5f">{"x":{"data":[{"x":[0,0.167891614087285,0.297064686872911,0.301295501426859,0.32459654925124,0.991282521176707,1],"y":[0,0.00524369341332589,0.0120882970367812,0.0123605441315182,0.0133134055121706,0.805325581946676,1],"text":["dC: 0<br>dEE: 0<br>ranks: 6","dC: 0.17<br>dEE: 0.01<br>ranks: 5","dC: 0.3<br>dEE: 0.01<br>ranks: 4","dC: 0.3<br>dEE: 0.01<br>ranks: 3","dC: 0.32<br>dEE: 0.01<br>ranks: 2","dC: 0.99<br>dEE: 0.81<br>ranks: 1","dC: 1<br>dEE: 1<br>ranks: 0"],"key":null,"type":"scatter","mode":"lines","name":"","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text"},{"x":[1,0.991282521176707,0.32459654925124,0.301295501426859,0.297064686872911,0.167891614087285,0],"y":[1,0.805325581946676,0.0133134055121706,0.0123605441315182,0.0120882970367812,0.00524369341332589,0],"text":["dC: 1<br>dEE: 1<br>ranks: 0","dC: 0.99<br>dEE: 0.81<br>ranks: 1","dC: 0.32<br>dEE: 0.01<br>ranks: 2","dC: 0.3<br>dEE: 0.01<br>ranks: 3","dC: 0.3<br>dEE: 0.01<br>ranks: 4","dC: 0.17<br>dEE: 0.01<br>ranks: 5","dC: 0<br>dEE: 0<br>ranks: 6"],"key":null,"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":18.8976377952756,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""},{"x":[1,0.991282521176707,0.32459654925124,0.301295501426859,0.297064686872911,0.167891614087285,0],"y":[1,0.805325581946676,0.0133134055121706,0.0123605441315182,0.0120882970367812,0.00524369341332589,0],"text":[0,1,2,3,4,5,6],"key":null,"textfont":{"size":15.1181102362205,"color":"rgba(255,255,255,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","name":""}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"CVA Rank Trace Plot, k = 0","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-0.05,1.05],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"dC","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-0.05,1.05],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"dE","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_error)</code></pre></div>
<pre><code>## function (x, y, x_new, y_new, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### create training and test sets

num_obs &lt;-<span class="st"> </span><span class="kw">dim</span>(galaxy)[<span class="dv">1</span>]
train_number &lt;-<span class="st"> </span><span class="kw">floor</span>(.<span class="dv">75</span> *<span class="st"> </span>num_obs)
train_index &lt;-<span class="st"> </span><span class="kw">sample</span>(num_obs, train_number)

### training set
train_galaxy_x &lt;-<span class="st"> </span>galaxy_x[train_index, ]
train_galaxy_y &lt;-<span class="st"> </span>galaxy_y[train_index, ]

### test set
test_galaxy_x &lt;-<span class="st"> </span>galaxy_x[-train_index, ]
test_galaxy_y &lt;-<span class="st"> </span>galaxy_y[-train_index, ]</code></pre></div>
</div>
</div>
<div id="diagnostics" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#diagnostics" class="anchor"> </a></body></html>Diagnostics</h2>
<div id="calculate-residuals-with-cva_residuals" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#calculate-residuals-with-cva_residuals" class="anchor"> </a></body></html>Calculate residuals with <code><a href="../reference/cva_residuals.html">cva_residuals()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_residuals)</code></pre></div>
<pre><code>## function (x, y, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_residuals.html">cva_residuals</a></span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)</code></pre></div>
<pre><code>## # A tibble: 3,462 &times; 3
##    index        CV1        CV2
##    &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1      1 -0.3202596  0.5609487
## 2      2 -0.3373066 -0.3235156
## 3      3  0.2342563  0.2243338
## 4      4  0.2188205  0.6709930
## 5      5 -0.7183237  1.5344605
## 6      6 -1.0225019  0.1872628
## 7      7  0.2784014  0.5923622
## 8      8 -0.1242796  0.6893633
## 9      9  0.2544044  0.2704908
## 10    10 -0.6856947 -0.1686793
## # ... with 3,452 more rows</code></pre>
</div>
<div id="plot-residuals-with-cva_residual_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#plot-residuals-with-cva_residual_plot" class="anchor"> </a></body></html>Plot Residuals with <code><a href="../reference/cva_residual_plot.html">cva_residual_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_residual_plot.html">cva_residual_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="plot-pairwise-canonical-variate-scores-with-cva_pairwise_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#plot-pairwise-canonical-variate-scores-with-cva_pairwise_plot" class="anchor"> </a></body></html>Plot Pairwise Canonical Variate Scores with <code><a href="../reference/cva_pairwise_plot.html">cva_pairwise_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_pairwise_plot.html">cva_pairwise_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">cva_pair =</span> <span class="dv">1</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_pairwise_plot.html">cva_pairwise_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">cva_pair =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-14-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_pairwise_plot.html">cva_pairwise_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">cva_pair =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_pairwise_plot.html">cva_pairwise_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">cva_pair =</span> <span class="dv">6</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-15-2.png" width="672"></p>
</div>
</div>
<div id="fit-reduced-rank-canonical-variate-model" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#fit-reduced-rank-canonical-variate-model" class="anchor"> </a></body></html>Fit Reduced-Rank Canonical Variate Model</h2>
<div id="fit-model-with-cva" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#fit-model-with-cva" class="anchor"> </a></body></html>Fit model with <code><a href="../reference/cva.html">cva()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva)</code></pre></div>
<pre><code>## function (x, y, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva.html">cva</a></span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<pre><code>## $mean
##           [,1]
## [1,] 28.388670
## [2,]  1.087370
## [3,] 26.721374
## [4,] -1.166768
## [5,] -1.025344
## [6,]  2.080132
## 
## $G
##            UjMAG       BjMAG      VjMAG      usMAG       gsMAG      rsMAG
## [1,]  0.08245937 0.002984345  0.8404642 0.06621581 -0.08236586 -0.5801623
## [2,] -1.49675657 0.025440724 -3.5397513 2.13792464  0.85714917  2.9283156
##           UbMAG       BbMAG       VnMAG     S280MAG     W420FE    W462FE
## [1,]  0.2621465 -0.13452477  0.01348103 0.005561194  -1.486574 -1.270471
## [2,] -1.0059161  0.04282791 -0.05596699 0.036077743 -15.768191 -6.405781
##         W485FD     W518FE     W571FS    W604FE     W646FD     W696FE
## [1,] -1.241862 -0.0135883 -0.4363435 0.6564723  0.9527079  0.7664007
## [2,] -1.115042  8.1665877  3.6251209 3.6098337 -1.4617020 -5.0376775
##        W753FE     W815FS      W856FD    W914FD     W914FE
## [1,] 1.769078  0.1174032 -0.09706001 -1.957314 -0.4242234
## [2,] 3.334887 -8.2879583 -0.73423587  2.118483  1.9730962
## 
## $H
##           Rmag    ApDRmag      mumax        Mcz      MCzml    chi2red
## [1,] 0.5617072  0.4771916 -0.1235694 -1.4243677 -1.3820735  0.5999989
## [2,] 0.2899655 -0.1054661  0.4309957  0.5848668  0.5736387 -0.2302836
## 
## $canonical_corr
## [1] 0.93863397 0.46957833 0.07553122 0.02573175 0.01503215 0.01113977</code></pre>
</div>
<div id="calculate-canonical-variate-scores-with-cva_scores" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#calculate-canonical-variate-scores-with-cva_scores" class="anchor"> </a></body></html>Calculate Canonical Variate Scores with <code><a href="../reference/cva_scores.html">cva_scores()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_scores)</code></pre></div>
<pre><code>## function (x, y, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cva_scores.html">cva_scores</a></span>(galaxy_x, galaxy_y, <span class="dt">k =</span> <span class="fl">0.0001</span>)

scores</code></pre></div>
<pre><code>## $xi
## # A tibble: 3,462 &times; 6
##            xi1         xi2         xi3          xi4           xi5
##          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
## 1   0.10939069  0.37863862  0.09371909 -0.003416401  0.0304444050
## 2  -0.03538215  1.44069847  0.59607833 -0.030832491 -1.1786675532
## 3  -1.00592711  0.13378629 -0.07555343  0.075422524 -0.0103557500
## 4   0.04954501  0.09491797  0.13809968 -0.046355061  0.0658264675
## 5   0.08832029 -0.08406486 -0.94084545 -0.087123895 -0.1673241799
## 6  -0.54188182  0.60825647 -0.21698924 -0.189999849 -0.0109414043
## 7   0.43229161  0.55503061  0.30205123 -0.103879503  0.1676262684
## 8   0.54398298  0.34909483 -0.36149807 -0.183401317  0.0534814641
## 9   0.08025841  0.25643637  0.01428582  0.116461965 -0.0002147714
## 10  3.02965620 -0.65724548  0.19306838 -0.005443985  0.1183344965
## # ... with 3,452 more rows, and 1 more variables: xi6 &lt;dbl&gt;
## 
## $omega
## # A tibble: 3,462 &times; 6
##         omega1     omega2      omega3      omega4      omega5     omega6
##          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1   0.13299889 -0.2173703 -0.82056198  2.36274461  1.87573329 -2.7920084
## 2  -0.03692747  1.4276006  0.58346789 -0.03508845 -1.15833053 -0.4571182
## 3  -1.39563939 -0.2373857  0.63559910 -0.33690047  1.94034502 -2.4384869
## 4   0.08731544  1.0810924  1.86899400  0.13642828 -0.12305606 -1.9836103
## 5   0.52632555  0.1414576 -7.69998276 -3.47083455 -0.43477107  2.9161274
## 6  -0.54285403  0.7202036 -3.06887667 -2.24228337 -2.47056921  2.0813830
## 7   0.45612941  1.0018636  0.02338828 -0.74050515  0.39177820 -0.1386883
## 8   0.07037098  1.1413856  0.34575432 -0.34985205  0.07238352  1.3803591
## 9   0.25717552  0.4112277  0.66382655  0.42277241  0.32681940 -0.8157131
## 10  2.60406898 -0.5219489 -0.13703696 -0.72516693 -0.46445692 -1.5229440
## # ... with 3,452 more rows
## 
## $canonical_corr
## [1] 0.93863397 0.46957833 0.07553122 0.02573175 0.01503215 0.01113977</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggcorr</span>(scores[[<span class="st">"xi"</span>]])</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GGally::<span class="kw">ggcorr</span>(scores[[<span class="st">"omega"</span>]])</code></pre></div>
<p><img src="cva_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#mathematical-background">Mathematical Background</a></li>
      <li><a href="#the-combo17-data-set">The <code>COMBO17</code> Data Set</a></li>
      <li><a href="#assessing-effective-dimensionality">Assessing Effective Dimensionality</a></li>
      <li><a href="#diagnostics">Diagnostics</a></li>
      <li><a href="#fit-reduced-rank-canonical-variate-model">Fit Reduced-Rank Canonical Variate Model</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Chris Addy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
