<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title><code>rrr</code> for Multivariate Analysis &bull; rrr</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rrr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/chrisaddy/rrr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1><code>rrr</code> for Multivariate Analysis</h1>
                        <h4 class="author">Chris Addy</h4>
            
            <h4 class="date">2016-11-22</h4>
          </div>

    
    
<div class="contents">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rrr)</code></pre></div>
<div id="reduced-rank-regression" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#reduced-rank-regression" class="anchor"> </a></body></html>Reduced-Rank Regression</h2>
<div id="classical-multivariate-regression" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#classical-multivariate-regression" class="anchor"> </a></body></html>Classical Multivariate Regression</h3>
<p>Let <span class="math inline">\(\mathbf{X} = \left(X_1, X_2, \dots, X_r\right)^\tau\)</span> and <span class="math inline">\(\mathbf{Y} = \left(Y_1, Y_2, \dots, Y_s\right)^\tau\)</span>, i.e., <span class="math inline">\(\mathbf{X}\)</span> is a random vector. The classical multivariate regression model is given by</p>
<p><span class="math display">\[
\overset{s \times 1}{\mathbf{Y}} = \overset{s \times 1}{\boldsymbol{\mu}} + \overset{s \times r}{\mathbf{C}} \; \overset{r \times 1}{\mathbf{X}} + \overset{s \times 1}{\varepsilon}
\]</span></p>
<p>with</p>
<p><span class="math display">\[
\mathrm{E}\left(\varepsilon\right) = \mathbf{0}, \quad \mathrm{cov}\left(\varepsilon\right) = \mathbf{\Sigma}_{\varepsilon \varepsilon}
\]</span></p>
<p>and <span class="math inline">\(\varepsilon\)</span> is distributed independently of <span class="math inline">\(\mathbf{X}.\)</span></p>
<p>The least-squares estimator is given by</p>
<p><span class="math display">\[
\hat{\mathbf{C}} = \hat{\mathbf{\Sigma}}_{YX} \hat{\mathbf{\Sigma}}_{XX}^{-1}
\]</span></p>
<p>Note that <span class="math inline">\(\hat{\mathbf{C}}\)</span> contains no term that takes into the account the correlation of the <span class="math inline">\(Y_i\)</span>s. This is a surprising result, since we would expect correlation, perhaps very heavy correlation, among the responses.</p>
<p>In other words, to find the least-squares estimate <span class="math inline">\(\hat{\mathbf{C}}\)</span> of <span class="math inline">\(\mathbf{C}\)</span>, one need only regress <span class="math inline">\(\mathbf{X}\)</span> separately on each <span class="math inline">\(Y_i\)</span> and concatenate those multiple-regression coefficient vectors into a matrix to construct the estimated coefficient matrix <span class="math inline">\(\hat{\mathbf{C}}\)</span>.</p>
<p>The classical multivariate regression model is not <em>truly</em> multivariate.</p>
</div>
<div id="multivariate-regression-the-tobacco-data-set" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#multivariate-regression-the-tobacco-data-set" class="anchor"> </a></body></html>Multivariate Regression: The Tobacco Data Set</h3>
<p>One way to introduce a multivariate component into the model is to allow for the possibility that <span class="math inline">\(\mathbf{C}\)</span> is deficient, or of <em>reduced-rank</em> <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
\mathrm{rank}\left(\mathbf{C}\right) = t \leq \mathrm{min}\left(r, s\right)
\]</span></p>
<p>In other words, we allow for the possibility that there are unknown linear constraints on <span class="math inline">\(\mathbf{C}\)</span>.</p>
<p>Without loss of generality, we consider the case when <span class="math inline">\(r &gt; s\)</span>, i.e., <span class="math inline">\(t &lt; s\)</span>.</p>
<p>When <span class="math inline">\(t = s\)</span>, the regression model is <em>full-rank</em>, and can be fit using multiple regression on each <span class="math inline">\(Y_i \in \mathbf{Y}.\)</span> When <span class="math inline">\(t &lt; s\)</span>, <span class="math inline">\(\mathbf{C}\)</span> can be decomposed into non-unique matrices <span class="math inline">\(\mathbf{A}_{s \times t}\)</span> and <span class="math inline">\(\mathbf{B}_{t \times r}\)</span>, such that <span class="math inline">\(\mathbf{C} = \mathbf{AB},\)</span> and the multivariate regression model is given by</p>
<p><span class="math display">\[
\overset{s \times 1}{\mathbf{Y}} = \overset{s \times 1}{\boldsymbol{\mu}} + \overset{s \times t}{\mathbf{A}} \; \overset{t \times r}{\mathbf{B}} \; \overset{r \times 1}{\mathbf{X}} + \overset{s \times 1}{\varepsilon}
\]</span></p>
<p>Estimating <span class="math inline">\(\boldsymbol{\mu}, \mathbf{A}, \mathbf{B}\)</span>, and ultimately the <em>reduced-rank regression coefficient</em> <span class="math inline">\(\mathbf{C}^{\left(t\right)}\)</span>, is done by minimizing the weighted sum-of-squares criterion</p>
<p><span class="math display">\[
\mathrm{E}\left[\left(\mathbf{Y} - \boldsymbol{\mu} - \mathbf{ABX}\right)^\tau \mathbf{\Gamma}\left(\mathbf{Y} - \boldsymbol{\mu} - \mathbf{ABX}\right)\right]
\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{\Gamma}\)</span> is a positive-definite symmetric <span class="math inline">\(\left(s \times s\right)\)</span>-matrix of weights, the expectation of which is taken over the joint distribution <span class="math inline">\(\left(\mathbf{X}^\tau, \mathbf{Y}^\tau\right)^\tau\)</span>. This weighted sum-of-squares criterion is minimized when</p>
<p><span class="math display">\[
\begin{aligned}
\boldsymbol{\mu}^{\left(t\right)} &amp; = \boldsymbol{\mu}_Y - \mathbf{A}^{\left(t\right)}\mathbf{B}^{\left(t\right)}\boldsymbol{\mu}_X \\
        \mathbf{A}^{\left(t\right)} &amp; = \mathbf{\Gamma}^{-1/2}\mathbf{V}_t \\
        \mathbf{B}^{\left(t\right)} &amp; = \mathbf{V}_t^\tau \boldsymbol{\Gamma}^{-1/2}\mathbf{\Sigma}_{YX}\mathbf{\Sigma}_{XX}^{-1} \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{V}_t = \left(\mathbf{v}_1, \dots, \mathbf{v}_t\right)\)</span> is an <span class="math inline">\(\left(s \times t\right)\)</span>-matrix, with <span class="math inline">\(\mathbf{v}_j\)</span> the eigenvector associated with the <span class="math inline">\(j\)</span>th largest eigenvalue of</p>
<p><span class="math display">\[
\mathbf{\Gamma}^{1/2}\mathbf{\Sigma}_{YX} \mathbf{\Sigma}_{XX}^{-1} \mathbf{\Sigma}_{XY} \mathbf{\Gamma}^{1/2}
\]</span></p>
<p>In practice, we try out different values of <span class="math inline">\(\mathbf{\Gamma}\)</span>. Two popular choices &ndash; and ones that lead to interesting results as we will see &ndash; are <span class="math inline">\(\mathbf{\Gamma} = \mathbf{I}_r\)</span> and <span class="math inline">\(\mathbf{\Gamma} = \boldsymbol{\Sigma}_{YY}^{-1}\)</span>.</p>
<p>Since the reduced-rank regression coefficient relies on inverting <span class="math inline">\(\boldsymbol{\Sigma}_{XX}\)</span> and, possibly, <span class="math inline">\(\boldsymbol{\Sigma}_{YY}\)</span>, we want to take into consideration the cases when <span class="math inline">\(\boldsymbol{\Sigma}_{XX}, \boldsymbol{\Sigma}_{YY}\)</span> are singular or difficult to invert.</p>
<p>Borrowing from ridge regression, we perturb the diagonal of the covariance matrices by some small constant, <span class="math inline">\(k\)</span>. Thus, we carry out the reduced-rank regression procedure using</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\boldsymbol{\Sigma}}_{XX}^{\left(k\right)} &amp; = \hat{\boldsymbol{\Sigma}}_{XX} + k \mathbf{I}_r \\
\hat{\boldsymbol{\Sigma}}_{YY}^{\left(k\right)} &amp; = \hat{\boldsymbol{\Sigma}}_{YY} + k \mathbf{I}_r
\end{aligned}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">data</span>(tobacco)

tobacco &lt;-<span class="st"> </span><span class="kw">as_data_frame</span>(tobacco)

tobacco_x &lt;-<span class="st"> </span>tobacco %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"X"</span>))

tobacco_y &lt;-<span class="st"> </span>tobacco %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">"Y"</span>))
    
## multivariate regression

x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tobacco_x)
y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tobacco_y)

multivar_reg &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">cov</span>(y, x) %*%<span class="st"> </span><span class="kw">solve</span>(<span class="kw">cov</span>(x)))

## separate multiple regression

lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y[,<span class="dv">1</span>] ~<span class="st"> </span>x)$coeff
lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y[,<span class="dv">2</span>] ~<span class="st"> </span>x)$coeff
lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y[,<span class="dv">3</span>] ~<span class="st"> </span>x)$coeff

### compare multivariate regression and separate multiple regresions

multivar_reg</code></pre></div>
<pre><code>##                      Y1.BurnRate Y2.PercentSugar Y3.PercentNicotine
## X1.PercentNitrogen    0.06197282      -4.3186662          0.5521620
## X2.PercentChlorine   -0.16012848       1.3262863         -0.2785609
## X3.PercentPotassium   0.29211810       1.5899470          0.2175877
## X4.PercentPhosphorus -0.65798016      13.9526510         -0.7231067
## X5.PercentCalcium     0.17302593       0.5525913          0.3230914
## X6.PercentMagnesium  -0.42834825      -3.5021083          2.0048603</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(lm1, lm2, lm3)</code></pre></div>
<pre><code>##                               lm1        lm2        lm3
## (Intercept)            1.41113730 13.6329133 -1.5648236
## xX1.PercentNitrogen    0.06197282 -4.3186662  0.5521620
## xX2.PercentChlorine   -0.16012848  1.3262863 -0.2785609
## xX3.PercentPotassium   0.29211810  1.5899470  0.2175877
## xX4.PercentPhosphorus -0.65798016 13.9526510 -0.7231067
## xX5.PercentCalcium     0.17302593  0.5525913  0.3230914
## xX6.PercentMagnesium  -0.42834825 -3.5021083  2.0048603</code></pre>
</div>
<div id="the-reduced-rank-regression-approach" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#the-reduced-rank-regression-approach" class="anchor"> </a></body></html>The Reduced-Rank Regression Approach</h3>
</div>
<div id="fit-reduced-rank-regression-with-rrr" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#fit-reduced-rank-regression-with-rrr" class="anchor"> </a></body></html>Fit Reduced-Rank Regression with <code><a href="../reference/rrr.html">rrr()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rrr)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<p>The main function in the <code>rrr</code> package is &ndash; unsurprisingly &ndash; <code><a href="../reference/rrr.html">rrr()</a></code></p>
<p><code><a href="../reference/rrr.html">rrr()</a></code> takes as inputs the data frames, or matrices, of input and response variables, the weight matrix <span class="math inline">\(\mathbf{\Gamma}\)</span>, the rank (defaulted to full rank), the type of covariance matrix to be used (either covariance or correlation), and the ridge constant <span class="math inline">\(k\)</span>.</p>
<p><code><a href="../reference/rrr.html">rrr()</a></code> returns a <code>list</code> containing the means <span class="math inline">\(\hat{\boldsymbol{\mu}}\)</span>, the matrices <span class="math inline">\(\hat{\mathbf{A}}\)</span>, <span class="math inline">\(\hat{\mathbf{B}}\)</span>, and the coefficient matrix <span class="math inline">\(\hat{\mathbf{C}}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### use the identity matrix for gamma
ident &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span>, <span class="kw">dim</span>(tobacco_y)[<span class="dv">2</span>])

<span class="kw"><a href="../reference/rrr.html">rrr</a></span>(tobacco_x, tobacco_y, ident, <span class="dt">rank =</span> <span class="st">"full"</span>) </code></pre></div>
<pre><code>## $mean
##           [,1]
## [1,]  1.411137
## [2,] 13.632913
## [3,] -1.564824
## 
## $A
##             [,1]       [,2]      [,3]
## [1,]  0.03107787 -0.4704307 0.8818895
## [2,] -0.97005030  0.1984637 0.1400521
## [3,]  0.24090782  0.8598297 0.4501736
## 
## $B
##      X1.PercentNitrogen X2.PercentChlorine X3.PercentPotassium
## [1,]          4.3242696        -1.35864835          -1.4808316
## [2,]         -0.4114869         0.09903401           0.3652138
## [3,]         -0.3016163        -0.08086722           0.5782436
##      X4.PercentPhosphorus X5.PercentCalcium X6.PercentMagnesium
## [1,]           -13.729424        -0.4528289          3.86689562
## [2,]             2.456879         0.3060762          1.23030547
## [3,]             1.048309         0.3754285          0.03430168
## 
## $C
##      X1.PercentNitrogen X2.PercentChlorine X3.PercentPotassium
## [1,]         0.06197282         -0.1601285           0.2921181
## [2,]        -4.31866620          1.3262863           1.5899470
## [3,]         0.55216201         -0.2785609           0.2175877
##      X4.PercentPhosphorus X5.PercentCalcium X6.PercentMagnesium
## [1,]           -0.6579802         0.1730259          -0.4283482
## [2,]           13.9526510         0.5525913          -3.5021083
## [3,]           -0.7231067         0.3230914           2.0048603
## 
## $eigen_values
## [1] 3.28209974 0.03782978 0.01015996</code></pre>
<p>We can see that <code><a href="../reference/rrr.html">rrr()</a></code> with <code>rank = "full"</code> and <code>k = 0</code> returns the classical multivariate regression coefficients as before. They differ only by a transpose, and is presented this way in <code>rrr</code> as a matter of convention. It is this form that is presented in the literature (Izenman, 2008).</p>
</div>
<div id="assess-effective-dimensionality-t-and-ridge-constant-k-with-rank_trace_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#assess-effective-dimensionality-t-and-ridge-constant-k-with-rank_trace_plot" class="anchor"> </a></body></html>Assess Effective Dimensionality <span class="math inline">\(t\)</span> and Ridge Constant <span class="math inline">\(k\)</span> with <code><a href="../reference/rank_trace_plot.html">rank_trace_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rank_trace)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(rank_trace_plot)</code></pre></div>
<pre><code>## function (x, y, gamma_matrix, type = "cov", k = 0) 
## NULL</code></pre>
<p>Since <span class="math inline">\(\hat{\mathbf{C}}\)</span> is calculated using sample observations, its <em>mathematical</em> rank will always be full, but it will have a <em>statistical</em> rank <span class="math inline">\(t\)</span> that is an unknown hyperparameter that</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rank_trace.html">rank_trace</a></span>(tobacco_x, tobacco_y, ident) </code></pre></div>
<pre><code>## # A tibble: 4 &times; 3
##   ranks         dC         dEE
##   &lt;int&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     0 1.00000000 1.000000000
## 2     1 0.20198327 0.011933691
## 3     2 0.08419093 0.003095346
## 4     3 0.00000000 0.000000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rank_trace_plot.html">rank_trace_plot</a></span>(tobacco_x, tobacco_y, ident)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
</div>
<div id="principle-components-analysis" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#principle-components-analysis" class="anchor"> </a></body></html>Principle Components Analysis</h2>
<p><span class="math display">\[
\begin{aligned}
  \mathbf{A}^{\left(t\right)} &amp; = \left(\mathbf{v}_1, \dots, \mathbf{v}_t\right) \\
  \mathbf{B}^{\left(t\right)} &amp; = \mathbf{A}^{\left(t\right) \tau} \\
  \boldsymbol{\mu}^{\left(t\right)} &amp; = \left(\mathbf{I}_r - \mathbf{A}^{\left(t\right)}\mathbf{B}^{\left(t\right)}\right)\boldsymbol{\mu}_X \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{v}_j = \mathbf{v}_j \left(\mathbf{\Sigma}_{XX}\right)\)</span> is eigenvector associated with the <span class="math inline">\(j\)</span>th largest eigenvalue of <span class="math inline">\(\mathbf{\Sigma}_{XX}.\)</span></p>
<p>The best reduced-rank approximation to the original <span class="math inline">\(\mathbf{X}\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\mathbf{X}}^{\left(t\right)} &amp; =
  \boldsymbol{\mu}^{\left(t\right)} + \mathbf{A}^{\left(t\right)}\mathbf{B}^{\left(t\right)} \mathbf{X}
\end{aligned}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(pendigits)
digits &lt;-<span class="st"> </span><span class="kw">as_data_frame</span>(pendigits)

digits_class &lt;-<span class="st"> </span>digits %&gt;%<span class="st"> </span>dplyr::<span class="kw">select</span>(V35)
digits_features &lt;-<span class="st"> </span>digits %&gt;%<span class="st"> </span>dplyr::<span class="kw">select</span>(-V5, -V6)

digits_pca &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rrpca.html">rrpca</a></span>(digits_features)

digits_pca</code></pre></div>
<pre><code>## $means
## # A tibble: 34 &times; 1
##       value
## *     &lt;dbl&gt;
## 1  38.81432
## 2  85.12027
## 3  40.60562
## 4  83.77420
## 5  51.22025
## 6  44.49900
## 7  56.86854
## 8  33.69596
## 9  60.51638
## 10 34.82651
## # ... with 24 more rows
## 
## $C
## # A tibble: 34 &times; 34
##               V1            V2            V3            V4            V5
##            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1   1.000000e+00 -1.942890e-16  1.526557e-16  1.021318e-16 -2.775558e-16
## 2  -1.942890e-16  1.000000e+00  4.414871e-16 -2.914335e-16 -1.318390e-16
## 3   1.526557e-16  4.414871e-16  1.000000e+00  1.231654e-16  1.222980e-16
## 4   1.021318e-16 -2.914335e-16  1.231654e-16  1.000000e+00 -4.145989e-16
## 5  -2.775558e-16 -1.318390e-16  1.222980e-16 -4.145989e-16  1.000000e+00
## 6  -1.110223e-16 -5.551115e-17  6.591949e-17 -4.718448e-16  1.179612e-16
## 7  -1.114560e-16  3.816392e-17  9.194034e-17  3.400058e-16 -5.377643e-17
## 8   2.324529e-16 -1.110223e-16  1.023487e-16 -2.706169e-16  1.214306e-16
## 9  -2.081668e-17  1.106428e-16 -3.489098e-17  7.047314e-17 -4.069282e-16
## 10  2.498002e-16 -4.163336e-17 -5.637851e-17 -2.428613e-17  1.405126e-16
## # ... with 24 more rows, and 29 more variables: V6 &lt;dbl&gt;, V7 &lt;dbl&gt;,
## #   V8 &lt;dbl&gt;, V9 &lt;dbl&gt;, V10 &lt;dbl&gt;, V11 &lt;dbl&gt;, V12 &lt;dbl&gt;, V13 &lt;dbl&gt;,
## #   V14 &lt;dbl&gt;, V15 &lt;dbl&gt;, V16 &lt;dbl&gt;, V17 &lt;dbl&gt;, V18 &lt;dbl&gt;, V19 &lt;dbl&gt;,
## #   V20 &lt;dbl&gt;, V21 &lt;dbl&gt;, V22 &lt;dbl&gt;, V23 &lt;dbl&gt;, V24 &lt;dbl&gt;, V25 &lt;dbl&gt;,
## #   V26 &lt;dbl&gt;, V27 &lt;dbl&gt;, V28 &lt;dbl&gt;, V29 &lt;dbl&gt;, V30 &lt;dbl&gt;, V31 &lt;dbl&gt;,
## #   V32 &lt;dbl&gt;, V33 &lt;dbl&gt;, V34 &lt;dbl&gt;
## 
## $PC
## # A tibble: 34 &times; 34
##            PC1         PC2         PC3           PC4          PC5
##          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
## 1  -0.03387102  0.13029152 -0.36925608 -0.0557669954 -0.455824378
## 2   0.02889750  0.04894617 -0.10146162  0.0297692102 -0.052485351
## 3  -0.10713998 -0.10659910 -0.19971425 -0.1867322127  0.086694722
## 4  -0.05936310 -0.13286056 -0.12306986  0.0003095884 -0.045021414
## 5  -0.08459809 -0.06412648  0.33637840 -0.2417182761 -0.230328973
## 6  -0.26801027 -0.13483718  0.08883391  0.0108538776 -0.024645693
## 7  -0.22122135  0.18873574  0.21627977  0.0448592607 -0.252691425
## 8  -0.19776810  0.07579367  0.19075917  0.0530807274 -0.014630565
## 9  -0.22462146  0.32671341 -0.05358243  0.1570188597  0.222779203
## 10  0.05618133  0.21562910  0.20521911  0.0728999493 -0.002345969
## # ... with 24 more rows, and 29 more variables: PC6 &lt;dbl&gt;, PC7 &lt;dbl&gt;,
## #   PC8 &lt;dbl&gt;, PC9 &lt;dbl&gt;, PC10 &lt;dbl&gt;, PC11 &lt;dbl&gt;, PC12 &lt;dbl&gt;, PC13 &lt;dbl&gt;,
## #   PC14 &lt;dbl&gt;, PC15 &lt;dbl&gt;, PC16 &lt;dbl&gt;, PC17 &lt;dbl&gt;, PC18 &lt;dbl&gt;,
## #   PC19 &lt;dbl&gt;, PC20 &lt;dbl&gt;, PC21 &lt;dbl&gt;, PC22 &lt;dbl&gt;, PC23 &lt;dbl&gt;,
## #   PC24 &lt;dbl&gt;, PC25 &lt;dbl&gt;, PC26 &lt;dbl&gt;, PC27 &lt;dbl&gt;, PC28 &lt;dbl&gt;,
## #   PC29 &lt;dbl&gt;, PC30 &lt;dbl&gt;, PC31 &lt;dbl&gt;, PC32 &lt;dbl&gt;, PC33 &lt;dbl&gt;, PC34 &lt;dbl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pca_gof.html">pca_gof</a></span>(digits_features) %&gt;%<span class="st"> </span><span class="kw">round</span>(<span class="dv">4</span>)</code></pre></div>
<pre><code>##  [1] 0.7143 0.4689 0.3080 0.2272 0.1695 0.1181 0.0870 0.0589 0.0408 0.0270
## [11] 0.0186 0.0120 0.0075 0.0039 0.0020 0.0007 0.0003 0.0000 0.0000 0.0000
## [21] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
## [31] 0.0000 0.0000 0.0000 0.0000</code></pre>
<div id="assess-effective-dimensionality-t-and-ridge-constant-k-with-pca_rank_trace_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#assess-effective-dimensionality-t-and-ridge-constant-k-with-pca_rank_trace_plot" class="anchor"> </a></body></html>Assess Effective Dimensionality <span class="math inline">\(t\)</span> and ridge constant <span class="math inline">\(k\)</span> with <code><a href="../reference/pca_rank_trace_plot.html">pca_rank_trace_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(pca_rank_trace)</code></pre></div>
<pre><code>## function (x, type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(pca_rank_trace_plot)</code></pre></div>
<pre><code>## function (x, type = "cov", k = 0, interactive = FALSE) 
## NULL</code></pre>
<p><code><a href="../reference/pca_rank_trace.html">pca_rank_trace()</a></code> and <code><a href="../reference/pca_rank_trace_plot.html">pca_rank_trace_plot()</a></code> are special of <code><a href="../reference/rank_trace.html">rank_trace()</a></code> and <code><a href="../reference/rank_trace_plot.html">rank_trace_plot()</a></code>, respectively, when <span class="math inline">\(\mathbf{Y} \equiv \mathbf{X}\)</span> and <span class="math inline">\(\mathbf{\Gamma} = \mathbf{I}_r\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pca_rank_trace.html">pca_rank_trace</a></span>(digits_features)</code></pre></div>
<pre><code>## # A tibble: 35 &times; 3
##     rank   delta_C delta_residuals
##    &lt;int&gt;     &lt;dbl&gt;           &lt;dbl&gt;
## 1      0 1.0000000      1.00000000
## 2      1 0.9851844      0.71433119
## 3      2 0.9701425      0.46892679
## 4      3 0.9548637      0.30799061
## 5      4 0.9393364      0.22717008
## 6      5 0.9235481      0.16953413
## 7      6 0.9074852      0.11807750
## 8      7 0.8911328      0.08697453
## 9      8 0.8744746      0.05887330
## 10     9 0.8574929      0.04079132
## # ... with 25 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pca_rank_trace_plot.html">pca_rank_trace_plot</a></span>(digits_features)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="plot-principal-component-scores-with-pc_pairwise_plot-and-pc_all_pairs_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#plot-principal-component-scores-with-pc_pairwise_plot-and-pc_all_pairs_plot" class="anchor"> </a></body></html>Plot Principal Component Scores with <code><a href="../reference/pc_pairwise_plot.html">pc_pairwise_plot()</a></code> and <code>pc_all_pairs_plot()</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(pc_pairwise_plot)</code></pre></div>
<pre><code>## function (x, pc_x = 1, pc_y = 2, class_labels = NULL, rank = "full", 
##     type = "cov", interactive = FALSE) 
## NULL</code></pre>
<p>A common PCA method of visualization for diagnostic and analysis purposes is to plot the <span class="math inline">\(j\)</span>th sample PC scores against the <span class="math inline">\(k\)</span>th PC scores,</p>
<p><span class="math display">\[
\begin{aligned}
  \left(\xi_{ij}, \xi_{ik}\right) \\
  \left(\hat{\mathbf{v}}_j^\tau \mathbf{X}_i, \hat{\mathbf{v}}_k^\tau\right),  \quad i = 1,2, \dots, n  
\end{aligned}
\]</span></p>
<p>Since the first two principal components will capture the most variance &ndash; and hence the most useful information &ndash; of all possible pairs of principal components, we typically would set <span class="math inline">\(j = 1, k = 2\)</span> and plot the first two sample PC scores against each other. In <code>rrr</code> this is the default.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pc_pairwise_plot.html">pc_pairwise_plot</a></span>(digits_features, <span class="dt">class_labels =</span> digits_class)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>We can set the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-axes to whichever pairs of PC scores we would like to plot by changing the <code>pc_x</code> and <code>pc_y</code> arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pc_pairwise_plot.html">pc_pairwise_plot</a></span>(digits_features, <span class="dt">pc_x =</span> <span class="dv">1</span>, <span class="dt">pc_y =</span> <span class="dv">3</span>, <span class="dt">class_labels =</span> digits_class)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="plot-all-pairs-of-pc-scores-with-pc_allpairs_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#plot-all-pairs-of-pc-scores-with-pc_allpairs_plot" class="anchor"> </a></body></html>Plot all pairs of PC scores with <code><a href="../reference/pc_allpairs_plot.html">pc_allpairs_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(pc_allpairs_plot)</code></pre></div>
<pre><code>## function (x, rank, type = "cov", k = 0, class_labels = NULL) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/pc_allpairs_plot.html">pc_allpairs_plot</a></span>(digits_features, <span class="dt">rank =</span> <span class="dv">3</span>, <span class="dt">class_labels =</span> digits_class)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="rrr_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#pc_plot_3D(digits_features, class_labels = digits_class)</span></code></pre></div>
</div>
</div>
<div id="canonical-variate-analysis" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#canonical-variate-analysis" class="anchor"> </a></body></html>Canonical Variate Analysis</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### COMBO-17 galaxy data
<span class="kw">data</span>(COMBO17)
galaxy &lt;-<span class="st"> </span><span class="kw">as_data_frame</span>(COMBO17) %&gt;%
<span class="st">  </span><span class="kw">na.omit</span>() %&gt;%
<span class="st">  </span><span class="kw">select</span>(-<span class="kw">starts_with</span>(<span class="st">"e."</span>), -Nr, -UFS:-IFD)

galaxy_x &lt;-<span class="st"> </span>galaxy %&gt;%<span class="st"> </span><span class="kw">select</span>(-Rmag:-chi2red)
galaxy_y &lt;-<span class="st"> </span>galaxy %&gt;%<span class="st"> </span><span class="kw">select</span>(Rmag:chi2red)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(galaxy)</code></pre></div>
<pre><code>## Observations: 3,438
## Variables: 29
## $ Rmag    &lt;dbl&gt; 24.995, 25.013, 24.246, 25.203, 25.504, 23.740, 25.706...
## $ ApDRmag &lt;dbl&gt; 0.935, -0.135, 0.821, 0.639, -1.588, -1.636, 0.199, -0...
## $ mumax   &lt;dbl&gt; 24.214, 25.303, 23.511, 24.948, 24.934, 24.609, 25.271...
## $ Mcz     &lt;dbl&gt; 0.832, 0.927, 1.202, 0.912, 0.848, 0.882, 0.896, 0.930...
## $ MCzml   &lt;dbl&gt; 1.400, 0.864, 1.217, 0.776, 1.330, 0.877, 0.870, 0.877...
## $ chi2red &lt;dbl&gt; 0.64, 0.41, 0.92, 0.39, 1.45, 0.52, 1.31, 1.84, 1.03, ...
## $ UjMAG   &lt;dbl&gt; -17.67, -18.28, -19.75, -17.83, -17.69, -19.22, -17.09...
## $ BjMAG   &lt;dbl&gt; -17.54, 17.86, -19.91, -17.39, -18.40, -18.11, -16.06,...
## $ VjMAG   &lt;dbl&gt; -17.76, -18.20, -20.41, -17.67, -19.37, -18.70, -16.23...
## $ usMAG   &lt;dbl&gt; -17.83, -18.42, -19.87, -17.98, -17.81, -19.34, -17.26...
## $ gsMAG   &lt;dbl&gt; -17.60, -17.96, -20.05, -17.47, -18.69, -18.27, -16.11...
## $ rsMAG   &lt;dbl&gt; -17.97, -18.43, -20.71, -17.89, -19.88, -19.05, -16.39...
## $ UbMAG   &lt;dbl&gt; -17.76, -18.36, -19.82, -17.92, -17.76, -19.30, -17.19...
## $ BbMAG   &lt;dbl&gt; -17.53, -17.85, -19.89, -17.38, -18.35, -18.08, -16.05...
## $ VnMAG   &lt;dbl&gt; -17.76, -18.19, -20.40, -17.67, -19.37, -18.69, -16.22...
## $ S280MAG &lt;dbl&gt; -18.22, -17.97, -19.77, -18.12, -13.93, -19.18, -17.81...
## $ W420FE  &lt;dbl&gt; 0.0006600, 0.0003240, 0.0129700, 0.0118600, 0.0013450,...
## $ W462FE  &lt;dbl&gt; 0.012700, 0.005135, 0.019670, 0.015900, 0.005088, 0.00...
## $ W485FD  &lt;dbl&gt; 0.0188500, 0.0027290, 0.0255200, 0.0015550, 0.0018450,...
## $ W518FE  &lt;dbl&gt; 0.0182300, 0.0007852, 0.0159200, 0.0026140, 0.0099620,...
## $ W571FS  &lt;dbl&gt; 0.014680, 0.009910, 0.022890, 0.001756, 0.003439, 0.00...
## $ W604FE  &lt;dbl&gt; 0.016640, 0.009047, 0.023380, 0.009163, 0.006316, 0.00...
## $ W646FD  &lt;dbl&gt; 0.0188000, 0.0029790, 0.0231200, 0.0063330, -0.0001841...
## $ W696FE  &lt;dbl&gt; 0.024620, 0.009830, 0.027220, 0.012330, 0.005536, 0.00...
## $ W753FE  &lt;dbl&gt; 0.024470, 0.014210, 0.035440, 0.002250, 0.016170, 0.01...
## $ W815FS  &lt;dbl&gt; 0.021560, 0.014710, 0.045340, 0.016880, 0.006755, 0.00...
## $ W856FD  &lt;dbl&gt; 0.024410, 0.011420, 0.078100, 0.008749, 0.010220, 0.00...
## $ W914FD  &lt;dbl&gt; 0.0377200, 0.0102800, 0.0711400, 0.0069970, 0.0132800,...
## $ W914FE  &lt;dbl&gt; 0.011660, 0.026270, 0.064050, 0.005865, 0.019850, 0.02...</code></pre>
<div id="assess-effective-dimensionality-t-and-ridge-constant-k-with-cva_rank_trace_plot" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#assess-effective-dimensionality-t-and-ridge-constant-k-with-cva_rank_trace_plot" class="anchor"> </a></body></html>Assess Effective Dimensionality <span class="math inline">\(t\)</span> and Ridge Constant <span class="math inline">\(k\)</span> with <code><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_rank_trace)</code></pre></div>
<pre><code>## function (x, y, type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_rank_trace_plot)</code></pre></div>
<pre><code>## function (x, y, type = "cov", k = 0) 
## NULL</code></pre>
<p>As with <code><a href="../reference/rank_trace_plot.html">rank_trace_plot()</a></code> and <code><a href="../reference/pca_rank_trace_plot.html">pca_rank_trace_plot()</a></code>, we can visually assess the rank <span class="math inline">\(t\)</span> with <code><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot()</a></code>. <code><a href="../reference/cva_rank_trace.html">cva_rank_trace()</a></code> and <code><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot()</a></code> serve as wrappers to the functions <code><a href="../reference/rank_trace.html">rank_trace()</a></code> and <code>rank_trace_plot</code>, respectively, setting <span class="math inline">\(\mathbf{\Gamma} = \mathbf{\Sigma}_{YY}^{-1}\)</span>, or <code>gamma_matrix = cov(y)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot</a></span>(galaxy_x, galaxy_y)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
<div id="measure-covariance-and-correlation-of-canonical-variate-scores-with-canonical_cov" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#measure-covariance-and-correlation-of-canonical-variate-scores-with-canonical_cov" class="anchor"> </a></body></html>Measure Covariance and Correlation of Canonical Variate Scores with <code>canonical_cov</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(canonical_cov)</code></pre></div>
<pre><code>## function (x, y, rank = "full", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(canonical_corr)</code></pre></div>
<pre><code>## function (x, y, rank = "full", type = "cov", k = 0) 
## NULL</code></pre>
<p>The covariance matrix of the canonical variate scores, <span class="math inline">\(\mathrm{cov}\left\{\boldsymbol{\xi}^{\left(t\right)}, \boldsymbol{\omega}^{\left(t\right)}\right\}\)</span>, is calculated with <code><a href="../reference/canonical_cov.html">canonical_cov()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/canonical_cov.html">canonical_cov</a></span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<pre><code>##              xi1       xi2        xi3    omega1    omega2     omega3
## xi1    0.9385535 0.0000000 0.00000000 0.9385535 0.0000000 0.00000000
## xi2    0.0000000 0.4784141 0.00000000 0.0000000 0.4784141 0.00000000
## xi3    0.0000000 0.0000000 0.06437355 0.0000000 0.0000000 0.06437355
## omega1 0.9385535 0.0000000 0.00000000 1.0000000 0.0000000 0.00000000
## omega2 0.0000000 0.4784141 0.00000000 0.0000000 1.0000000 0.00000000
## omega3 0.0000000 0.0000000 0.06437355 0.0000000 0.0000000 1.00000000</code></pre>
<p>The correlation matrix of the canonical variate scores, <span class="math inline">\(\mathrm{corr}\left\{\boldsymbol{\xi}^{\left(t\right)}, \boldsymbol{\omega}^{\left(t\right)}\right\}\)</span>, is calculated with <code><a href="../reference/canonical_corr.html">canonical_corr()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/canonical_corr.html">canonical_corr</a></span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<pre><code>##              xi1       xi2       xi3    omega1    omega2    omega3
## xi1    1.0000000 0.0000000 0.0000000 0.9687897 0.0000000 0.0000000
## xi2    0.0000000 1.0000000 0.0000000 0.0000000 0.6916749 0.0000000
## xi3    0.0000000 0.0000000 1.0000000 0.0000000 0.0000000 0.2537194
## omega1 0.9687897 0.0000000 0.0000000 1.0000000 0.0000000 0.0000000
## omega2 0.0000000 0.6916749 0.0000000 0.0000000 1.0000000 0.0000000
## omega3 0.0000000 0.0000000 0.2537194 0.0000000 0.0000000 1.0000000</code></pre>
</div>
<div id="assess-effective-dimensionality-t-and-ridge-constant-k-with-cva_rank_trace_plot-1" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#assess-effective-dimensionality-t-and-ridge-constant-k-with-cva_rank_trace_plot-1" class="anchor"> </a></body></html>Assess Effective Dimensionality <span class="math inline">\(t\)</span> and Ridge Constant <span class="math inline">\(k\)</span> with <code><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot()</a></code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_rank_trace)</code></pre></div>
<pre><code>## function (x, y, type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(cva_rank_trace_plot)</code></pre></div>
<pre><code>## function (x, y, type = "cov", k = 0) 
## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_rank_trace_plot.html">cva_rank_trace_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cva_residual_plot.html">cva_residual_plot</a></span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="fl">0.0001</span>)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-25-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#cva_residual_3D_plot(galaxy_x, galaxy_y, k = 0.0001)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cv_pair1 &lt;-<span class="st"> </span><span class="kw">cv_pairwise_plot</span>(galaxy_x, galaxy_y, <span class="dt">k =</span> <span class="fl">0.001</span>)
cv_pair1</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cv_pair2 &lt;-<span class="st"> </span><span class="kw">cv_pairwise_plot</span>(galaxy_x, galaxy_y, <span class="dt">cv_pair =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)
cv_pair3 &lt;-<span class="st"> </span><span class="kw">cv_pairwise_plot</span>(galaxy_x, galaxy_y, <span class="dt">cv_pair =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)
cv_pair4 &lt;-<span class="st"> </span><span class="kw">cv_pairwise_plot</span>(galaxy_x, galaxy_y, <span class="dt">cv_pair =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)
cv_pair5 &lt;-<span class="st"> </span><span class="kw">cv_pairwise_plot</span>(galaxy_x, galaxy_y, <span class="dt">cv_pair =</span> <span class="dv">5</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)
cv_pair6 &lt;-<span class="st"> </span><span class="kw">cv_pairwise_plot</span>(galaxy_x, galaxy_y, <span class="dt">cv_pair =</span> <span class="dv">6</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gridExtra &lt;-<span class="st"> </span><span class="kw">grid.arrange</span>(cv_pair1,
                          cv_pair2, 
                          cv_pair3,
                          cv_pair4,
                          cv_pair5,
                          cv_pair6)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cv_allpairs_plot</span>(galaxy_x, galaxy_y, <span class="dt">rank =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="fl">0.001</span>)</code></pre></div>
<p><img src="rrr_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
</div>
</div>
<div id="linear-discriminant-analysis" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#linear-discriminant-analysis" class="anchor"> </a></body></html>Linear Discriminant Analysis</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### create training and test sets
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
num_obs &lt;-<span class="st"> </span><span class="kw">dim</span>(digits)[<span class="dv">1</span>]
train_number &lt;-<span class="st"> </span><span class="kw">floor</span>(.<span class="dv">75</span> *<span class="st"> </span>num_obs)
train_index &lt;-<span class="st"> </span><span class="kw">sample</span>(num_obs, train_number)

### training set
train_digits_features &lt;-<span class="st"> </span>digits_features[train_index, ]
train_digits_class &lt;-<span class="st"> </span>digits_class[train_index, ]

### test set
test_digits_features &lt;-<span class="st"> </span>digits_features[-train_index, ]
test_digits_class &lt;-<span class="st"> </span>digits_class[-train_index, ]</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#reduced-rank-regression">Reduced-Rank Regression</a></li>
      <li><a href="#principle-components-analysis">Principle Components Analysis</a></li>
      <li><a href="#canonical-variate-analysis">Canonical Variate Analysis</a></li>
      <li><a href="#linear-discriminant-analysis">Linear Discriminant Analysis</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Chris Addy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
